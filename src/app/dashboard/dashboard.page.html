<ion-content [fullscreen]="true">
  
  <div class="content-wrapper">
    <!-- Header Personalizado -->
    <div class="custom-header">
      <div class="header-content">
        <div class="header-title">
          <ion-icon name="water"></ion-icon>
          <div>
            <h1>Dashboard de Sensores</h1>
            <p>Monitoramento em tempo real</p>
          </div>
        </div>
        <div class="header-badge">
          <ion-icon name="pulse"></ion-icon>
          <span>Online</span>
        </div>
      </div>
    </div>
  
  <!-- Status de Atualização -->
  <ion-card class="status-card">
    <ion-card-content>
      <div class="status-content">
        <div class="status-info">
          <ion-icon 
            [name]="atualizacaoAutomatica ? 'sync-circle' : 'pause-circle'" 
            [color]="atualizacaoAutomatica ? 'success' : 'medium'"
            class="status-icon">
          </ion-icon>
          <div>
            <h3>{{ atualizacaoAutomatica ? 'Atualização Automática' : 'Atualização Pausada' }}</h3>
            <p *ngIf="ultimaAtualizacao" class="ultima-atualizacao">
              Última atualização: {{ ultimaAtualizacao | date:'dd/MM/yyyy HH:mm:ss' }}
            </p>
          </div>
        </div>
        
        <div class="status-actions">
          <ion-button 
            [color]="atualizacaoAutomatica ? 'medium' : 'success'" 
            (click)="toggleAtualizacaoAutomatica()"
            size="small">
            <ion-icon [name]="atualizacaoAutomatica ? 'pause' : 'play'" slot="start"></ion-icon>
            {{ atualizacaoAutomatica ? 'Pausar' : 'Iniciar' }}
          </ion-button>
          
          <ion-button 
            color="primary" 
            (click)="carregarDados()"
            [disabled]="carregando"
            size="small">
            <ion-icon name="refresh" slot="start"></ion-icon>
            {{ carregando ? 'Atualizando...' : 'Atualizar' }}
          </ion-button>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Grid de Sensores -->
  <div class="sensores-header">
    <h2>Leituras Atuais</h2>
    <ion-badge *ngIf="dadosSensores.length > 0" color="primary">
      {{ dadosSensores.length }} sensor(es)
    </ion-badge>
  </div>

  <ion-spinner *ngIf="carregando && dadosSensores.length === 0" name="crescent" class="spinner-center"></ion-spinner>

  <ion-grid *ngIf="!carregando || dadosSensores.length > 0">
    <ion-row>
      <ion-col size="12" size-md="6" size-lg="4" *ngFor="let sensor of dadosSensores">
        <ion-card class="sensor-card">
          
          <!-- Header do Card -->
          <ion-card-header>
            <div class="sensor-header">
              <div class="sensor-info">
                <ion-icon 
                  [name]="getIconeSensor(sensor.tipo || 'default')" 
                  [color]="getCorSensor(sensor.tipo || 'default')"
                  class="sensor-icon-large">
                </ion-icon>
                <div class="sensor-text">
                  <ion-card-title>{{ sensor.nome || sensor.tipo || 'Sensor' }}</ion-card-title>
                  <ion-card-subtitle *ngIf="sensor.localizacao">
                    <ion-icon name="location-outline"></ion-icon>
                    {{ sensor.localizacao }}
                  </ion-card-subtitle>
                </div>
              </div>
              
              <!-- Badge de Status -->
              <div class="status-badge" [class]="sensor.status || 'ativo'">
                {{ sensor.status || 'Ativo' }}
              </div>
            </div>
          </ion-card-header>
          
          <!-- Conteúdo do Card -->
          <ion-card-content>
            
            <!-- Timestamp -->
            <div class="sensor-timestamp">
              <ion-icon name="time-outline"></ion-icon>
              <span>{{ formatarData(sensor.timestamp || sensor.data) }}</span>
            </div>
            
            <!-- Grid de Medições -->
            <div class="medicoes-grid">
              
              <!-- Turbidez -->
              <div class="medicao-item" [class.indisponivel]="!sensor.turbidez">
                <div class="medicao-header">
                  <ion-icon name="contrast-outline" color="warning"></ion-icon>
                  <span class="medicao-label">Turbidez</span>
                </div>
                <div class="medicao-valor">
                  <span *ngIf="sensor.turbidez">{{ sensor.turbidez }}<span class="unidade">NTU</span></span>
                  <span *ngIf="!sensor.turbidez">N/D</span>
                </div>
              </div>
              
              <!-- pH -->
              <div class="medicao-item" [class.indisponivel]="!sensor.ph">
                <div class="medicao-header">
                  <ion-icon name="flask-outline" color="success"></ion-icon>
                  <span class="medicao-label">pH</span>
                </div>
                <div class="medicao-valor">
                  <span *ngIf="sensor.ph">{{ sensor.ph }}<span class="unidade">pH</span></span>
                  <span *ngIf="!sensor.ph">N/D</span>
                </div>
              </div>
              
              <!-- Cloro -->
              <div class="medicao-item" [class.indisponivel]="!sensor.cloro">
                <div class="medicao-header">
                  <ion-icon name="beaker-outline" color="tertiary"></ion-icon>
                  <span class="medicao-label">Cloro</span>
                </div>
                <div class="medicao-valor">
                  <span *ngIf="sensor.cloro">{{ sensor.cloro }}<span class="unidade">mg/L</span></span>
                  <span *ngIf="!sensor.cloro">N/D</span>
                </div>
              </div>
              
              <!-- Nível da Água -->
              <div class="medicao-item" [class.indisponivel]="!sensor.nivel_agua">
                <div class="medicao-header">
                  <ion-icon name="analytics-outline" color="secondary"></ion-icon>
                  <span class="medicao-label">Nível Água</span>
                </div>
                <div class="medicao-valor">
                  <span *ngIf="sensor.nivel_agua">{{ sensor.nivel_agua }}<span class="unidade">cm</span></span>
                  <span *ngIf="!sensor.nivel_agua">N/D</span>
                </div>
              </div>
              
            </div>
            
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-card *ngIf="!carregando && dadosSensores.length === 0" class="empty-state">
    <ion-card-content>
      <ion-icon name="cube-outline" class="empty-icon"></ion-icon>
      <h2>Nenhum dado disponível</h2>
      <p>Aguardando leituras dos sensores...</p>
    </ion-card-content>
  </ion-card>

  </div>
</ion-content>